<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>PremJourney</title>
		<script src="js/modernizr-custom.js"></script>
		<script type="text/javascript">
			Modernizer.load({
				test: Modernizr.svg && Modernizr.inlinesvg,
				yep: ['js/d3.js']	/*'js/d3.min.js*/
			});
		</script>
		<style type="text/css">
			/* Enter style rules here.*/
		</style>
	</head>

	<body>	
	<p>Click on this text to start the season! (once).</p>
	
		<script type="text/javascript">
		//--------------------------------------------------------------------------------//
		//-------------------------------- d3 block start --------------------------------//
		//--------------------------------------------------------------------------------//
		
		// Global Vrbles
		//--------------------------------------------------------------------------------//
		var Viz = {};	// dclre empty glbl objct
		Viz.pstnsCSV = "prem1516pstns20160126.csv";	// 24th Jan
		Viz.format = d3.time.format("%Y-%m-%d %H:%M:%S");	// evnt prsr
		//--------------------------------------------------------------------------------//
		
		// Load data.
		//--------------------------------------------------------------------------------//
		d3.csv(Viz.pstnsCSV,
			function(d) {return {
			goalTime: Viz.format.parse(d.goalTime),
			Arsenal: +d.Arsenal, AstonVilla: +d.AstonVilla, Bournemouth: +d.Bournemouth,
			Chelsea: +d.Chelsea, CrystalPalace: +d.CrystalPalace, Everton: +d.Everton,
			LeicesterCity: +d.LeicesterCity, Liverpool: +d.Liverpool,
			ManchesterCity: +d.ManchesterCity, ManchesterUnited: +d.ManchesterUnited,
			NewcastleUnited: +d.NewcastleUnited, NorwichCity: +d.NorwichCity,
			Southampton: +d.Southampton, StokeCity: +d.StokeCity, Sunderland: +d.Sunderland,
			SwanseaCity: +d.SwanseaCity, TottenhamHotspur: +d.TottenhamHotspur,
			Watford: +d.Watford, WestBromwichAlbion: +d.WestBromwichAlbion,
			WestHamUnited: +d.WestHamUnited
			};},	// loop thrgh ea row to ensre 100% loaded
			function(error, rows) {
				if (error) {
					console.log(error);
				} else {
					console.log(rows);	// debug
					buildViz(rows);
					}
			}
			); 	// csv() enclsng paren
		//--------------------------------------------------------------------------------//
			
		// Build viz
		//--------------------------------------------------------------------------------//
		function buildViz(events) {
			
		// Fnctn Scope Vrbles
		//--------------------------------------------------------------------------------//
		var noClubs = 20;

		var w = 500; 	// svg width
		var h = 100; 	// svg hght
		var pddng = 20; 	// svg pddng
		var iconPddng = 0.05; 	// % of ea icon band as space between ea other
		var intrpltn = 1000; 	// milli scnds between ea transition
			
		// Margins
		var margin = {top: pddng * 2, right: pddng, bottom: pddng * 2, left: pddng};
		 w = w - margin.left - margin.right;
		 h = h - margin.top - margin.bottom;
		
		// Create SVG element.
		var svg = d3.select("body")
					.append("svg")
					.attr("width", w + margin.left + margin.right)
					.attr("height", h + margin.top + margin.bottom)
					.append("g")
					.attr("transform", "translate(" + margin.left + "," + margin.top + ")");
					
		// Scales
		var xScale = d3.scale.ordinal()
						.domain(d3.range(noClubs))
						.rangeRoundBands([0, w], iconPddng);
						
		var yScale = d3.scale.linear()
								.domain([0, noClubs])
								.range([h, 0]);

		var sldrScale = d3.time.scale()
								.domain([0, d3.max(events, function(d) {return d;})])
								.range([0, w]);
		
		// Icons
		var icons = svg.selectAll("image")
						.data(events) 	// bind ea data elmnt to ea elmnt
					    .enter() 	// rtrn placehldr ref to ea new elmnt
					    .append("image") 	// add ea new elmnt to the DOM
					    .attr({
							"x": function(d, i) {return xScale(i);}, 	// hrzntl pstn
							"y": function(d) {return yScale(d.AstonVilla);}, 	// vrtcl pstn
							"height": 50, "width": 50,
							"xlink:href": "/icons/ManchesterUnitedV1.jpg"
							//"r": ((w / noClubs) - iconPddng) / 2
						});
		//--------------------------------------------------------------------------------//
			
		}  // buidViz enclsng brce
		//--------------------------------------------------------------------------------//

		//--------------------------------------------------------------------------------//
		//--------------------------------- d3 block end ---------------------------------//
		//--------------------------------------------------------------------------------//			
		</script>

	</body>
</html>
